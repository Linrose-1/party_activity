{"version":3,"file":"feedback.js","sources":["utils/feedback.js"],"sourcesContent":["// src/utils/feedback.js\r\n\r\n// 1. 定义音效文件的 URL\r\nconst POINTS_GAINED_SOUND_URL = 'https://img.gofor.club/20251119/retro-coin-4-236671_1763536579022.mp3';\r\n\r\n// 2. 创建并配置一个全局的 InnerAudioContext\r\n// 这样做可以避免在每次调用时都创建新的实例，但需要管理好播放状态\r\nconst audioContext = uni.createInnerAudioContext();\r\naudioContext.src = POINTS_GAINED_SOUND_URL;\r\naudioContext.autoplay = false; // 禁止自动播放\r\n\r\n// 3. 封装核心反馈函数\r\n/**\r\n * @description 显示获得贡分的反馈，包括音效和弹窗榜文。\r\n * @param {string} actionName - 触发获得贡分的行为名称，例如 '分享名片', '每日签到' 等。\r\n * @param {number|string} points - 获得的贡分数量。\r\n */\r\nexport function showPointsGainedFeedback(actionName, points) {\r\n\t// 安全检查，如果参数不合法则不执行\r\n\tif (!actionName || !points || points <= 0) {\r\n\t\tconsole.warn('showPointsGainedFeedback调用失败：缺少 actionName 或 points 参数。');\r\n\t\treturn;\r\n\t}\r\n\r\n\t// --- 播放音效 ---\r\n\t// 每次播放前，先停止上一次可能未播放完的音效并回到起点\r\n\taudioContext.stop();\r\n\taudioContext.seek(0);\r\n\taudioContext.play();\r\n\r\n\taudioContext.onPlay(() => {\r\n\t\tconsole.log('贡分音效开始播放');\r\n\t});\r\n\taudioContext.onError((res) => {\r\n\t\tconsole.error('贡分音效播放错误:', res.errMsg);\r\n\t});\r\n\r\n\r\n\t// --- 显示榜文弹窗 ---\r\n\tconst content = `恭喜您，今日${actionName}，您已获得 ${points} 贡分！\\n(贡分可用于获得参与平台分享的权益)`;\r\n\r\n\tuni.showModal({\r\n\t\ttitle: '恭喜获得贡分！',\r\n\t\tcontent: content,\r\n\t\tshowCancel: false, // 只保留一个确认按钮\r\n\t\tconfirmText: '太棒了！', // 自定义按钮文字\r\n\t\tsuccess: (res) => {\r\n\t\t\tif (res.confirm) {\r\n\t\t\t\tconsole.log('用户确认了贡分提示');\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\n\r\n// 默认导出一个包含所有反馈函数的对象（方便未来扩展）\r\nexport default {\r\n\tshowPointsGainedFeedback\r\n};"],"names":["uni"],"mappings":";;AAGA,MAAM,0BAA0B;AAIhC,MAAM,eAAeA,cAAAA,MAAI;AACzB,aAAa,MAAM;AACnB,aAAa,WAAW;"}