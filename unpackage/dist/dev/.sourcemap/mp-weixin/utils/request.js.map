{"version":3,"file":"request.js","sources":["utils/request.js"],"sourcesContent":["import {\r\n\tref\r\n} from 'vue';\r\n\r\n// 请求的基本配置\r\n// const baseURL = 'http://192.168.110.249:8080';\r\nconst baseURL = 'http://8.163.18.207:48080';\r\nconst timeout = 10000; // 请求超时\r\n\r\n// 封装请求方法\r\nconst request = async (url, options = {}) => {\r\n\tconst config = {\r\n\t\turl: baseURL + url,\r\n\t\tmethod: options.method || 'GET', // 默认为GET请求\r\n\t\tdata: options.data || {}, // 请求的数据\r\n\t\theader: options.header || {}, // 请求头\r\n\t\ttimeout: options.timeout || timeout, // 请求超时\r\n\t};\r\n\r\n\t// 获取 access_token 并加入请求头\r\n\tconst token = uni.getStorageSync('token');\r\n\tif (token) {\r\n\t  config.header['Authorization'] = `Bearer ${token}`; \r\n\t}\r\n\r\n\t// 添加 ngrok-skip-browser-warning 头\r\n\t// config.header['ngrok-skip-browser-warning'] = '69420';\r\n\r\n\ttry {\r\n\t\t// 使用 uni.request 来获取数据\r\n\t\tconst res = await uni.request(config); // 直接等待响应，不需要解构\r\n\r\n\t\tif (res.statusCode === 200) {\r\n\t\t\t// 判断返回的 code 字段是否为 200\r\n\t\t\tif (res.data.code === 0) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdata: res.data.data,\r\n\t\t\t\t\terror: null\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdata: null,\r\n\t\t\t\t\terror: res.data.msg || '请求失败'\r\n\t\t\t\t}; // 返回错误信息\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn {\r\n\t\t\t\tdata: null,\r\n\t\t\t\terror: '请求失败，状态码: ' + res.statusCode\r\n\t\t\t}; // 返回其他状态码的错误信息\r\n\t\t}\r\n\t} catch (err) {\r\n\t\t// 捕获网络或其他错误\r\n\t\treturn {\r\n\t\t\tdata: null,\r\n\t\t\terror: err.message || '网络错误'\r\n\t\t}; // 返回网络错误\r\n\t}\r\n};\r\n\r\n// 导出封装的请求方法\r\nexport default request;"],"names":["uni"],"mappings":";;AAMA,MAAM,UAAU;AAChB,MAAM,UAAU;AAGX,MAAC,UAAU,OAAO,KAAK,UAAU,OAAO;AAC5C,QAAM,SAAS;AAAA,IACd,KAAK,UAAU;AAAA,IACf,QAAQ,QAAQ,UAAU;AAAA;AAAA,IAC1B,MAAM,QAAQ,QAAQ,CAAE;AAAA;AAAA,IACxB,QAAQ,QAAQ,UAAU,CAAE;AAAA;AAAA,IAC5B,SAAS,QAAQ,WAAW;AAAA;AAAA,EAC9B;AAGC,QAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,MAAI,OAAO;AACT,WAAO,OAAO,eAAe,IAAI,UAAU,KAAK;AAAA,EACjD;AAKD,MAAI;AAEH,UAAM,MAAM,MAAMA,cAAAA,MAAI,QAAQ,MAAM;AAEpC,QAAI,IAAI,eAAe,KAAK;AAE3B,UAAI,IAAI,KAAK,SAAS,GAAG;AACxB,eAAO;AAAA,UACN,MAAM,IAAI,KAAK;AAAA,UACf,OAAO;AAAA,QACZ;AAAA,MACA,OAAU;AACN,eAAO;AAAA,UACN,MAAM;AAAA,UACN,OAAO,IAAI,KAAK,OAAO;AAAA,QAC5B;AAAA,MACI;AAAA,IACJ,OAAS;AACN,aAAO;AAAA,QACN,MAAM;AAAA,QACN,OAAO,eAAe,IAAI;AAAA,MAC9B;AAAA,IACG;AAAA,EACD,SAAQ,KAAK;AAEb,WAAO;AAAA,MACN,MAAM;AAAA,MACN,OAAO,IAAI,WAAW;AAAA,IACzB;AAAA,EACE;AACF;;"}